по поводу деления на пакеты по 2000. Каждому скрипту выделяется определенный объем оперативной памяти, если он превышен то получаем ошибку - memory_limit